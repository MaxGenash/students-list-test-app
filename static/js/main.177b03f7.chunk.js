(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{243:function(e,t,a){e.exports=a(491)},491:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(21),o=a(54),i=a(81),c=a(32),d=a(237),l=a(238),u=a.n(l),m=a(16),p={activeModal:null,modalProps:{}},E=a(25),f=a(72),h=a.n(f),D={studentsById:null,isFetchingData:!1,fetchDataError:""},b={gradesById:null,isFetchingData:!1,fetchDataError:""},g=Object(c.c)({modals:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;return"SHOW_MODAL"===t.type?Object(m.a)({},e,{activeModal:t.id,modalProps:t.modalProps}):"HIDE_MODAL"===t.type&&e.activeModal===t.id?Object(m.a)({},e,{activeModal:null,modalProps:{}}):e},grades:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_NEW_GRADE_RECORD":case"EDIT_GRADE_RECORD":return Object(m.a)({},e,{gradesById:Object(m.a)({},e.gradesById,Object(E.a)({},t.record.id,t.record))});case"DELETE_GRADE_RECORDS":return Object(m.a)({},e,{gradesById:h.a.omit(e.gradesById,t.ids)});case"FETCH_GRADES_RECORDS_REQUEST":return Object(m.a)({},e,{fetchDataError:"",isFetchingData:!0});case"FETCH_GRADES_RECORDS_SUCCESS":return Object(m.a)({},e,{fetchDataError:"",isFetchingData:!1,gradesById:Object(m.a)({},e.gradesById,t.gradesById)});case"FETCH_GRADES_RECORDS_FAIL":return Object(m.a)({},e,{isFetchingData:!1,fetchDataError:t.error,gradesById:null});default:return e}},students:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_NEW_STUDENT_RECORD":case"EDIT_STUDENT_RECORD":return Object(m.a)({},e,{studentsById:Object(m.a)({},e.studentsById,Object(E.a)({},t.record.id,t.record))});case"DELETE_STUDENT_RECORD":return Object(m.a)({},e,{studentsById:h.a.omit(e.studentsById,t.recordId)});case"FETCH_STUDENTS_RECORDS_REQUEST":return Object(m.a)({},e,{fetchDataError:"",isFetchingData:!0});case"FETCH_STUDENTS_RECORDS_SUCCESS":return Object(m.a)({},e,{fetchDataError:"",isFetchingData:!1,studentsById:Object(m.a)({},e.studentsById,t.studentsById)});case"FETCH_STUDENTS_RECORDS_FAIL":return Object(m.a)({},e,{isFetchingData:!1,fetchDataError:t.error,studentsById:null});default:return e}}}),y=u()({basename:""}),O=[d.a,Object(i.routerMiddleware)(y)],S=c.d.apply(void 0,[c.a.apply(void 0,O)].concat([])),C=Object(c.e)(Object(i.connectRouter)(y)(g),{},S),v=a(239),R=a(22),F=a(150),T=a(149),j=a(47),_=a(48),I=a(51),B=a(49),N=a(50),w=a(109),A=a.n(w),k=a(24),M=a.n(k),G=a(36),P=a.n(G),x=a(34),U=a.n(x),L=a(45),H=a.n(L),W=a(18),q=a.n(W),Q="modal-portal",J="GRADES_DATA_FORM",Y="STUDENTS_DATA_FORM",V=a(31),z=a.n(V),K=a(35),X=a.n(K),Z=a(68),$=a.n(Z),ee=a(69),te=a.n(ee),ae=a(70),ne=a.n(ae),re=a(71),se=a.n(re),oe=a(28),ie=a.n(oe),ce=function(e){function t(e){var a;return Object(j.a)(this,t),(a=Object(I.a)(this,Object(B.a)(t).call(this,e))).setFormData=function(e,t){a.setState({form:Object(m.a)({},a.state.form,Object(E.a)({},e,t.target.value))})},a.onFormSubmit=function(e){e.preventDefault(),a.props.onSubmit(Object(m.a)({},a.props.initialData,a.state.form))},a.state={form:{firstName:e.initialData.firstName||"",lastName:e.initialData.lastName||"",birthdayDate:e.initialData.birthdayDate||""}},a}return Object(N.a)(t,e),Object(_.a)(t,[{key:"render",value:function(){return r.a.createElement($.a,{open:!0,onClose:this.props.onClose},r.a.createElement(se.a,null," ",this.props.isEditMode?"Edit ":"Add a new "," student "),r.a.createElement(ne.a,null,r.a.createElement("form",{id:"students-data-form",onSubmit:this.onFormSubmit,"data-test":"students-data-form"},r.a.createElement(ie.a,{container:!0,spacing:24},r.a.createElement(ie.a,{item:!0,xs:12},r.a.createElement(X.a,{required:!0,label:"First Name",value:this.state.form.firstName,onChange:this.setFormData.bind(this,"firstName"),fullWidth:!0,inputProps:{"data-test":"students-data-form-firstName"}})),r.a.createElement(ie.a,{item:!0,xs:12},r.a.createElement(X.a,{required:!0,label:"Last Name",value:this.state.form.lastName,onChange:this.setFormData.bind(this,"lastName"),fullWidth:!0,inputProps:{"data-test":"students-data-form-lastName"}})),r.a.createElement(ie.a,{item:!0,xs:12},r.a.createElement(X.a,{required:!0,type:"date",label:"Birthday Date",value:this.state.form.birthdayDate.split("T")[0],onChange:this.setFormData.bind(this,"birthdayDate"),InputLabelProps:{shrink:!0},fullWidth:!0,inputProps:{"data-test":"students-data-form-birthdayDate"}}))))),r.a.createElement(te.a,null,r.a.createElement(z.a,{onClick:this.props.onClose,color:"primary","data-test":"students-data-btn-cancel"},"Cancel"),r.a.createElement(z.a,{color:"primary",type:"submit",form:"students-data-form","data-test":"students-data-btn-submit"},"Submit")))}}]),t}(r.a.Component);ce.defaultProps={isEditMode:!1,initialData:{}};var de=ce,le=function(e,t){return function(a){a({type:"SHOW_MODAL",id:e,modalProps:t})}},ue=function(e){return function(t){t({type:"HIDE_MODAL",id:e})}},me=a(241);function pe(e){return Math.max.apply(Math,Object(me.a)(Object.keys(e).map(Number)).concat([0]))+1}var Ee=function(){return function(e,t){t().students.studentsById||(e({type:"FETCH_STUDENTS_RECORDS_REQUEST"}),fetch("https://api.jsonbin.io/b/5c6335bba83a293177310e03/1",{mode:"cors",method:"get",headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(function(e){var t=e.headers.get("content-type");if(200===e.status&&t&&t.includes("application/json"))return e.json();throw new Error("Failed to fetch data")}).then(function(t){if(!t.success||!t.entities||!t.entities.studentsById)throw new Error("Failed to fetch data");e({type:"FETCH_STUDENTS_RECORDS_SUCCESS",studentsById:t.entities.studentsById})}).catch(function(t){e({type:"FETCH_STUDENTS_RECORDS_FAIL",error:t.message})}))}},fe=function(e){return function(t){e.id?t(function(e){return function(t){t({type:"EDIT_STUDENT_RECORD",record:e})}}(e)):t(function(e){return function(t,a){t({type:"CREATE_NEW_STUDENT_RECORD",record:Object(m.a)({},e,{id:pe(a().students.studentsById)})})}}(e)),t(ue(Y))}},he=function(e){return function(t){t({type:"DELETE_STUDENT_RECORD",recordId:e})}},De=function(e){function t(){var e,a;Object(j.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(I.a)(this,(e=Object(B.a)(t)).call.apply(e,[this].concat(s)))).getTableOptions=function(){return{filterType:"checkbox",print:!1,download:!1,filter:!1,selectableRows:!1,elevation:0,pagination:!1,responsive:"scroll",customToolbar:function(){return r.a.createElement(U.a,{title:"Add a new record"},r.a.createElement(M.a,{onClick:function(){return a.props.openStudentsDataForm({isEditMode:!1})},"data-test":"btn-add-student-record"},r.a.createElement(P.a,null," add ")))}}},a.getTableColumns=function(){return[{name:"Actions",options:{customBodyRender:function(e){var t={isEditMode:!0,initialData:a.props.studentsById[e]};return r.a.createElement("div",{className:a.props.classes.actionButtonsContainer},r.a.createElement(U.a,{title:"Edit the record"},r.a.createElement(M.a,{className:a.props.classes.actionButton,onClick:function(){return a.props.openStudentsDataForm(t)},"data-test":"btn-edit-student-record"},r.a.createElement(P.a,null," edit "))),r.a.createElement(U.a,{title:"Delete the record"},r.a.createElement(M.a,{className:a.props.classes.actionButton,onClick:function(){return a.props.deleteStudentRecord(e)},"data-test":"btn-delete-student-record"},r.a.createElement(P.a,null," delete "))))},filter:!1,sort:!1,download:!1}},{name:"First Name"},{name:"Last Name"},{name:"Age"},{name:"Birthday Date",options:{customBodyRender:function(e){return new Date(e).toLocaleDateString()}}}]},a}return Object(N.a)(t,e),Object(_.a)(t,[{key:"componentDidMount",value:function(){this.portalContainer=document.getElementById(Q),this.props.fetchStudentsRecords()}},{key:"render",value:function(){var e=this.props,t=e.tableData,a=e.studentsDataFormProps,n=e.closeStudentsDataForm,s=e.submitStudentsDataForm,o=e.isOpenStudentsDataForm,i=e.classes,c=e.fetchDataError,d=e.isFetchingData;return c?r.a.createElement(q.a,{align:"center",variant:"h5",className:i.errorMessage},c,r.a.createElement("br",null),"Try refreshing the page."):d?r.a.createElement(q.a,{align:"center",variant:"h5",className:i.loadingMessage},"Loading data..."):r.a.createElement("section",{"data-test":"students-page"},r.a.createElement(A.a,{data:t,columns:this.getTableColumns(),options:this.getTableOptions()}),o&&r.a.createElement(H.a,{container:this.portalContainer},r.a.createElement(de,Object.assign({},a,{onClose:n,onSubmit:s}))))}}]),t}(r.a.Component),be=Object(o.connect)(function(e){var t=e.modals,a=e.students;return{isOpenStudentsDataForm:t.activeModal===Y,studentsDataFormProps:t.modalProps||{},studentsById:a.studentsById,isFetchingData:a.isFetchingData||!a.studentsById,fetchDataError:a.fetchDataError,tableData:Object.values(a.studentsById||{}).map(function(e){var t,a=e.id,n=e.firstName,r=e.lastName,s=e.birthdayDate;return[a,n,r,(t=s,(new Date).getFullYear()-new Date(t).getFullYear()),s]})}},function(e){return Object(c.b)({openStudentsDataForm:function(e){return le(Y,e)},closeStudentsDataForm:function(){return ue(Y)},submitStudentsDataForm:fe,fetchStudentsRecords:Ee,deleteStudentRecord:he},e)})(Object(R.withStyles)(function(e){return{errorMessage:{margin:"".concat(3*e.spacing.unit,"px 0")},loadingMessage:{margin:"".concat(3*e.spacing.unit,"px 0")},actionButtonsContainer:{whiteSpace:"nowrap"},actionButton:Object(E.a)({},e.breakpoints.down("sm"),{padding:"5px"})}})(De)),ge=a(240),ye=a(53),Oe=a.n(ye),Se=a(42),Ce=a.n(Se),ve=a(46),Re=a.n(ve),Fe=function(e){function t(e){var a;return Object(j.a)(this,t),(a=Object(I.a)(this,Object(B.a)(t).call(this,e))).setFormData=function(e,t){a.setState({form:Object(m.a)({},a.state.form,Object(E.a)({},e,t.target.value))})},a.onFormSubmit=function(e){e.preventDefault(),a.props.onSubmit(Object(m.a)({},a.props.initialData,a.state.form))},a.state={form:{studentId:e.initialData.studentId||"",profession:e.initialData.profession||"",testDate:e.initialData.testDate||"",grade:e.initialData.grade||""}},a}return Object(N.a)(t,e),Object(_.a)(t,[{key:"render",value:function(){return r.a.createElement($.a,{open:!0,onClose:this.props.onClose},r.a.createElement(se.a,null," ",this.props.isEditMode?"Edit ":"Add a new "," grade "),r.a.createElement(ne.a,null,r.a.createElement("form",{id:"grades-data-form",onSubmit:this.onFormSubmit,"data-test":"grades-data-form"},r.a.createElement(ie.a,{container:!0,spacing:24},r.a.createElement(ie.a,{item:!0,xs:12},r.a.createElement(Ce.a,{fullWidth:!0},r.a.createElement(Oe.a,{htmlFor:"student-input"}," Student "),r.a.createElement(Re.a,{native:!0,required:!0,value:this.state.form.studentId,onChange:this.setFormData.bind(this,"studentId"),inputProps:{id:"student-input","data-test":"grades-data-form-studentId"}},r.a.createElement("option",{key:"none",value:""}),Object.entries(this.props.studentNamesById).map(function(e){var t=Object(ge.a)(e,2),a=t[0],n=t[1];return r.a.createElement("option",{value:a,key:a}," ",n," ")})))),r.a.createElement(ie.a,{item:!0,xs:12},r.a.createElement(Ce.a,{fullWidth:!0},r.a.createElement(X.a,{required:!0,label:"Profession",value:this.state.form.profession,onChange:this.setFormData.bind(this,"profession"),fullWidth:!0,inputProps:{"data-test":"grades-data-form-profession"}}))),r.a.createElement(ie.a,{item:!0,xs:12},r.a.createElement(Ce.a,{fullWidth:!0},r.a.createElement(X.a,{required:!0,type:"date",label:"Test Date",value:this.state.form.testDate.split("T")[0],onChange:this.setFormData.bind(this,"testDate"),InputLabelProps:{shrink:!0},inputProps:{"data-test":"grades-data-form-testDate"}}))),r.a.createElement(ie.a,{item:!0,xs:12},r.a.createElement(Ce.a,{fullWidth:!0},r.a.createElement(Oe.a,{htmlFor:"grade-input"}," Grade "),r.a.createElement(Re.a,{native:!0,required:!0,value:this.state.form.grade,onChange:this.setFormData.bind(this,"grade"),inputProps:{id:"grade-input","data-test":"grades-data-form-grade"}},r.a.createElement("option",{key:"none",value:""}),r.a.createElement("option",{key:"A",value:"A"}," A "),r.a.createElement("option",{key:"B",value:"B"}," B "),r.a.createElement("option",{key:"C",value:"C"}," C "),r.a.createElement("option",{key:"D",value:"D"}," D "),r.a.createElement("option",{key:"E",value:"E"}," E "),r.a.createElement("option",{key:"F",value:"F"}," F "))))))),r.a.createElement(te.a,null,r.a.createElement(z.a,{onClick:this.props.onClose,color:"primary","data-test":"grades-data-btn-cancel"},"Cancel"),r.a.createElement(z.a,{color:"primary",type:"submit",form:"grades-data-form","data-test":"grades-data-btn-submit"},"Submit")))}}]),t}(r.a.Component);Fe.defaultProps={isOpen:!1,isEditMode:!1,initialData:{}};var Te=Fe,je=function(){return function(e,t){t().grades.gradesById||(e({type:"FETCH_GRADES_RECORDS_REQUEST"}),fetch("https://api.jsonbin.io/b/5c633a2c6874aa33ba0de476",{mode:"cors",method:"get",headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(function(e){var t=e.headers.get("content-type");if(200===e.status&&t&&t.includes("application/json"))return e.json();throw new Error("Failed to fetch data")}).then(function(t){if(!t.success||!t.entities||!t.entities.gradesById)throw new Error("Failed to fetch data");e({type:"FETCH_GRADES_RECORDS_SUCCESS",gradesById:t.entities.gradesById})}).catch(function(t){e({type:"FETCH_GRADES_RECORDS_FAIL",error:t.message})}))}},_e=function(e){return function(t){e.id?t(function(e){return function(t){t({type:"EDIT_GRADE_RECORD",record:e})}}(e)):t(function(e){return function(t,a){t({type:"CREATE_NEW_GRADE_RECORD",record:Object(m.a)({},e,{id:pe(a().grades.gradesById)})})}}(e)),t(ue(J))}},Ie=function(e){return function(t){t({type:"DELETE_GRADE_RECORDS",ids:e})}},Be=function(e){function t(){var e,a;Object(j.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(I.a)(this,(e=Object(B.a)(t)).call.apply(e,[this].concat(s)))).getTableOptions=function(){return{filterType:"checkbox",print:!1,download:!1,filter:!1,selectableRows:!1,elevation:0,pagination:!1,responsive:"scroll",customToolbar:function(){return r.a.createElement(U.a,{title:"Add a new record"},r.a.createElement(M.a,{onClick:function(){return a.props.openGradesDataForm({isEditMode:!1})},"data-test":"btn-add-grade-record"},r.a.createElement(P.a,null," add ")))}}},a.getTableColumns=function(){return[{name:"Actions",options:{customBodyRender:function(e){var t={isEditMode:!0,initialData:a.props.gradesById[e]};return r.a.createElement("div",{className:a.props.classes.actionButtonsContainer},r.a.createElement(U.a,{title:"Edit the record"},r.a.createElement(M.a,{className:a.props.classes.actionButton,onClick:function(){return a.props.openGradesDataForm(t)},"data-test":"btn-edit-grade-record"},r.a.createElement(P.a,null," edit "))),r.a.createElement(U.a,{title:"Delete the record"},r.a.createElement(M.a,{className:a.props.classes.actionButton,onClick:function(){return a.props.deleteGradeRecords(e)},"data-test":"btn-delete-grade-record"},r.a.createElement(P.a,null," delete "))))},filter:!1,sort:!1,download:!1}},{name:"Student"},{name:"Profession"},{name:"Test Date",options:{customBodyRender:function(e){return new Date(e).toLocaleDateString()}}},{name:"Grade"}]},a}return Object(N.a)(t,e),Object(_.a)(t,[{key:"componentDidMount",value:function(){this.portalContainer=document.getElementById(Q),this.props.fetchStudentsRecords(),this.props.fetchGradesRecords()}},{key:"render",value:function(){var e=this.props,t=e.tableData,a=e.gradesDataFormProps,n=e.studentNamesById,s=e.closeGradesDataForm,o=e.submitGradesDataForm,i=e.isOpenGradesDataForm,c=e.classes,d=e.fetchDataError,l=e.isFetchingData;return d?r.a.createElement(q.a,{align:"center",variant:"h5",className:c.errorMessage},d,r.a.createElement("br",null),"Try refreshing the page."):l?r.a.createElement(q.a,{align:"center",variant:"h5",className:c.loadingMessage},"Loading data..."):r.a.createElement("section",{"data-test":"grades-page"},r.a.createElement(A.a,{data:t,columns:this.getTableColumns(),options:this.getTableOptions()}),i&&r.a.createElement(H.a,{container:this.portalContainer},r.a.createElement(Te,Object.assign({},a,{studentNamesById:n,onClose:s,onSubmit:o}))))}}]),t}(r.a.Component);function Ne(e,t){return e?e[t]?e[t].firstName+" "+e[t].lastName:"DELETED":"Loading..."}var we=Object(o.connect)(function(e){var t=e.modals,a=e.grades,n=e.students,r=n.studentsById;return{isOpenGradesDataForm:t.activeModal===J,gradesDataFormProps:t.modalProps||{},isFetchingData:n.isFetchingData||a.isFetchingData||!r||!a.gradesById,studentNamesById:r?h.a.mapValues(r,function(e){return e.firstName+" "+e.lastName}):null,gradesById:a.gradesById,fetchDataError:a.fetchDataError||n.fetchDataError,tableData:Object.values(a.gradesById||{}).map(function(e){var t=e.id,a=e.studentId,n=e.profession,s=e.testDate,o=e.grade;return[t,Ne(r,a),n,s,o]})}},function(e){return Object(c.b)({openGradesDataForm:function(e){return le(J,e)},closeGradesDataForm:function(){return ue(J)},submitGradesDataForm:_e,fetchGradesRecords:je,fetchStudentsRecords:Ee,deleteGradeRecords:Ie},e)})(Object(R.withStyles)(function(e){return{errorMessage:{margin:"".concat(3*e.spacing.unit,"px 0")},loadingMessage:{margin:"".concat(3*e.spacing.unit,"px 0")},actionButtonsContainer:{whiteSpace:"nowrap"},actionButton:Object(E.a)({},e.breakpoints.down("sm"),{padding:"5px"})}})(Be)),Ae=a(104),ke=a.n(Ae),Me=a(106),Ge=a.n(Me),Pe=a(79),xe=a.n(Pe),Ue=a(492),Le=a(151);var He=Object(Le.a)(function(e){return r.a.createElement(ke.a,{position:"static"},r.a.createElement(Ge.a,{variant:"fullWidth",value:e.location.pathname},r.a.createElement(xe.a,{label:"Students list",value:"/students",component:Ue.a,to:"/students"}),r.a.createElement(xe.a,{label:"Grades list",value:"/grades",component:Ue.a,to:"/grades"})))});var We=Object(R.withStyles)(function(e){return{footer:{backgroundColor:e.palette.background.default,padding:"".concat(e.spacing.unit,"px 0")}}})(function(e){var t=e.classes;return r.a.createElement("footer",{className:t.footer},r.a.createElement(q.a,{variant:"subtitle1",align:"center",color:"textSecondary",component:"p"},"Max Henash (c) 2019"))});var qe=Object(R.withStyles)(function(e){return{app:{display:"flex",flexDirection:"column",minHeight:"100vh",minWidth:"320px",backgroundColor:e.palette.background.paper},pageContainer:{flex:1}}})(function(e){var t=e.classes;return r.a.createElement("div",{className:t.app},r.a.createElement(He,null),r.a.createElement("main",{className:t.pageContainer},r.a.createElement(F.a,null,r.a.createElement(v.a,{path:"/grades",component:we}),r.a.createElement(v.a,{path:"/students",component:be}),r.a.createElement(T.a,{to:"/students"}))),r.a.createElement("div",{id:Q}),r.a.createElement(We,null))}),Qe=a(105),Je=a.n(Qe);Object(s.render)(r.a.createElement(o.Provider,{store:C},r.a.createElement(i.ConnectedRouter,{history:y},r.a.createElement(n.Fragment,null,r.a.createElement(Je.a,null),r.a.createElement(qe,null)))),document.querySelector("#root"))}},[[243,1,2]]]);
//# sourceMappingURL=main.177b03f7.chunk.js.map